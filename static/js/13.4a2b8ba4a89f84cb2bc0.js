webpackJsonp([13],{"1Sy3":function(t,e,o){"use strict";var i=o("BO1k"),a=o.n(i),s=o("woOf"),r=o.n(s),n=o("5aCZ"),l=o("e9xc"),m=o("kKCO"),c=o("vHhr"),p=o("jGPu"),d={cate_id:0,name:"",video_url:"",video_img:"",index_img:"",location:"",info:"",id:void 0,imgs:[],if_index:0,sort:0},u={id:void 0,title:"",info:"",img:""},g={name:"itemDetail",components:{Tinymce:n.a,Upload:l.a,FileUpload:m.a,Sticky:c.a},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,o,i){""===o?(t.$message({message:e.field+"为必传项",type:"error"}),i(null)):i()};return{postForm:r()({},d),imgsForm:r()({},u),loading:!1,cateOptions:[],dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建"},rules:{name:[{validator:e}],info:[{validator:e}],index_img:[{validator:e}],imgs:[{type:"array",required:!0,message:"数据必须在1-9个之间",min:1,max:9,trigger:"change"}]},imgsRules:{info:[{required:!0,message:"请输入内容",trigger:"blur"}],img:[{required:!0,message:"请上传图片",trigger:"change"}]}}},computed:{contentShortLength:function(){return null==this.postForm.info?0:this.postForm.info.length}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetchData(t)}else this.postForm=r()({},d);this.getTypes()},methods:{fetchData:function(t){var e=this;Object(p.c)(t).then(function(t){e.postForm=t.data}).catch(function(t){console.log(t)})},getTypes:function(){var t=this;Object(p.e)().then(function(e){t.cateOptions=e.data.data,t.cateOptions.push({id:0,name:"请选择"})})},submitForm:function(){var t=this;this.$refs.postForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.loading=!0,t.isEdit?Object(p.f)(t.postForm,t.postForm.id).then(function(){t.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})}):Object(p.a)(t.postForm).then(function(){t.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}),t.$router.push("/cases/case-list"),t.loading=!1})},handleCreate:function(){var t=this;this.imgsForm=r()({},u),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.imgsForm.clearValidate()})},createData:function(){var t=this;console.log("创建数据",this.imgsForm),console.log("创建数据个数",this.postForm.imgs.length),this.postForm.imgs.length>9&&(this.$message("最多只能上传9个"),this.dialogFormVisible=!1),this.$refs.imgsForm.validate(function(e){e&&(t.imgsForm.id=t.postForm.imgs.length+1,t.postForm.imgs.push(t.imgsForm),t.dialogFormVisible=!1)})},handleUpdate:function(t){var e=this;this.imgsForm=r()({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.imgsForm.clearValidate()})},updateData:function(){var t=this;this.$refs.imgsForm.validate(function(e){if(e){var o=!0,i=!1,s=void 0;try{for(var r,n=a()(t.postForm.imgs);!(o=(r=n.next()).done);o=!0){var l=r.value;if(l.id===t.imgsForm.id){var m=t.postForm.imgs.indexOf(l);t.postForm.imgs.splice(m,1,t.imgsForm);break}}}catch(t){i=!0,s=t}finally{try{!o&&n.return&&n.return()}finally{if(i)throw s}}t.dialogFormVisible=!1}})},deleteData:function(t){var e=this.postForm.imgs.indexOf(t);this.postForm.imgs.splice(e,1)}}},f={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"createPost-container"},[o("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[o("sticky",{attrs:{className:"sub-navbar draft"}},[o("router-link",{attrs:{to:"/cases/case-list"}},[o("el-button",{staticStyle:{margin:"10px","margin-bottom":"0"},attrs:{type:"primary",icon:"el-icon-back"}},[t._v("返回列表")])],1),t._v(" "),o("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{margin:"10px",float:"right","margin-bottom":"0"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("发布")])],1),t._v(" "),o("div",{staticClass:"createPost-main-container"},[o("el-form-item",{attrs:{label:"案例名称",prop:"name"}},[o("el-input",{model:{value:t.postForm.name,callback:function(e){t.$set(t.postForm,"name",e)},expression:"postForm.name"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"分类",prop:"cid"}},[o("el-select",{attrs:{clearable:"",placeholder:"选择分类"},model:{value:t.postForm.cate_id,callback:function(e){t.$set(t.postForm,"cate_id",e)},expression:"postForm.cate_id"}},t._l(t.cateOptions,function(t){return o("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),o("el-form-item",{attrs:{label:"首图",prop:"index_img"}},[o("el-col",{attrs:{span:6}},[o("Upload",{model:{value:t.postForm.index_img,callback:function(e){t.$set(t.postForm,"index_img",e)},expression:"postForm.index_img"}})],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"案例特点",prop:"imgs"}},[o("div",{staticClass:"list-add"},[o("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("添加特点")])],1),t._v(" "),o("div",{staticClass:"list-items"},[o("ul",t._l(t.postForm.imgs,function(e,i){return o("li",{staticClass:"detail-item",staticStyle:{"border-bottom":"1px solid #eee","padding-bottom":"5px"}},[o("el-col",{staticStyle:{"padding-right":"5px","text-align":"right","line-height":"70px",color:"#606266"},attrs:{span:2}},[o("b",[t._v("特点"+t._s(i+1)+":")])]),t._v(" "),o("el-col",{staticStyle:{"padding-left":"5px","padding-right":"5px","padding-top":"15px"},attrs:{span:10}},[o("b",{staticStyle:{color:"gray"},domProps:{innerHTML:t._s(e.title)}}),t._v(" "),o("br"),t._v(" "),o("p",{staticStyle:{color:"gray","line-height":"18px"},domProps:{innerHTML:t._s(e.info)}})]),t._v(" "),o("el-col",{attrs:{span:6}},[o("img",{staticStyle:{float:"left","margin-left":"5px","margin-top":"5px"},attrs:{src:e.img,width:"auto",height:"80"}})]),t._v(" "),o("el-col",{staticStyle:{"padding-top":"20px"},attrs:{span:6}},[o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(o){t.handleUpdate(e)}}},[t._v("修改")]),t._v(" "),o("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(o){t.deleteData(e)}}},[t._v("删除")])],1),t._v(" "),o("div",{staticStyle:{clear:"both",width:"100%",height:"0"}})],1)}))])]),t._v(" "),o("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"45px",label:"简介",prop:"info"}},[o("el-col",{attrs:{span:10}},[o("el-input",{staticClass:"article-textarea",attrs:{type:"textarea",rows:5,autosize:"",placeholder:"请输入内容"},model:{value:t.postForm.info,callback:function(e){t.$set(t.postForm,"info",e)},expression:"postForm.info"}}),t._v(" "),o("span",{directives:[{name:"show",rawName:"v-show",value:t.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.contentShortLength)+"字")])],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"视频封面",prop:"video_img"}},[o("el-col",{attrs:{span:6}},[o("Upload",{model:{value:t.postForm.video_img,callback:function(e){t.$set(t.postForm,"video_img",e)},expression:"postForm.video_img"}})],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"视频",prop:"video_url"}},[o("FileUpload",{model:{value:t.postForm.video_url,callback:function(e){t.$set(t.postForm,"video_url",e)},expression:"postForm.video_url"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"首页展示"}},[o("el-radio-group",{model:{value:t.postForm.if_index,callback:function(e){t.$set(t.postForm,"if_index",e)},expression:"postForm.if_index"}},[o("el-radio",{attrs:{label:0}},[t._v("否")]),t._v(" "),o("el-radio",{attrs:{label:1}},[t._v("是")])],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"工程地点",prop:"location"}},[o("el-input",{attrs:{size:"small",placeholder:"例如：广东,深圳"},model:{value:t.postForm.location,callback:function(e){t.$set(t.postForm,"location",e)},expression:"postForm.location"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"排序",prop:"sort"}},[o("el-input",{attrs:{size:"small",placeholder:"值越大越靠前"},model:{value:t.postForm.sort,callback:function(e){t.$set(t.postForm,"sort",e)},expression:"postForm.sort"}})],1)],1)],1),t._v(" "),o("el-dialog",{staticClass:"imgs",attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,width:"60%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"imgsForm",attrs:{model:t.imgsForm,rules:t.imgsRules,size:"small"}},[o("el-form-item",{attrs:{label:"标题",prop:"title"}},[o("el-col",{attrs:{span:8}},[o("el-input",{model:{value:t.imgsForm.title,callback:function(e){t.$set(t.imgsForm,"title",e)},expression:"imgsForm.title"}})],1)],1),t._v(" "),o("el-form-item",{attrs:{label:"描述",prop:"info"}},[o("el-input",{attrs:{type:"textarea",rows:3,autosize:"",placeholder:"请输入内容"},model:{value:t.imgsForm.info,callback:function(e){t.$set(t.imgsForm,"info",e)},expression:"imgsForm.info"}})],1),t._v(" "),o("el-form-item",{attrs:{label:"图片",prop:"img"}},[o("el-col",{attrs:{span:6}},[o("Upload",{model:{value:t.imgsForm.img,callback:function(e){t.$set(t.imgsForm,"img",e)},expression:"imgsForm.img"}})],1)],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?o("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("添加")]):o("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("更新")])],1)],1)],1)},staticRenderFns:[]};var v=o("VU/8")(g,f,!1,function(t){o("ZXYL")},"data-v-a371a3de",null);e.a=v.exports},Y18V:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i={name:"createForm",components:{ItemDetail:o("1Sy3").a}},a={render:function(){var t=this.$createElement;return(this._self._c||t)("item-detail",{attrs:{"is-edit":!1}})},staticRenderFns:[]},s=o("VU/8")(i,a,!1,null,null,null);e.default=s.exports},ZXYL:function(t,e,o){var i=o("hhW1");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);o("rjj0")("2a1de4a0",i,!0)},hhW1:function(t,e,o){(t.exports=o("FZ+f")(!1)).push([t.i,'\n.data-item[data-v-a371a3de] {\n  background-color: #00b7ee;\n}\n.createPost-container[data-v-a371a3de] {\n  position: relative;\n}\n.createPost-container .createPost-main-container[data-v-a371a3de] {\n    padding: 40px 45px 20px 50px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-a371a3de] {\n      position: relative;\n      margin-bottom: 10px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-a371a3de]:after {\n        content: "";\n        display: table;\n        clear: both;\n}\n.createPost-container .createPost-main-container .postInfo-container .postInfo-container-item[data-v-a371a3de] {\n        float: left;\n}\n.createPost-container .createPost-main-container .editor-container[data-v-a371a3de] {\n      min-height: 500px;\n      margin: 0 0 30px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container[data-v-a371a3de] {\n        text-align: right;\n        margin-right: 10px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container .editor-upload-btn[data-v-a371a3de] {\n          display: inline-block;\n}\n.createPost-container .word-counter[data-v-a371a3de] {\n    width: 40px;\n    position: absolute;\n    right: -10px;\n    top: 0px;\n}\n',""])}});