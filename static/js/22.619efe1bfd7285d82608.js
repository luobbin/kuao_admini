webpackJsonp([22],{I9Id:function(t,e,a){"use strict";var n=a("woOf"),o=a.n(n),i=(a("mw3O"),a("YVAe")),r=a("D4dz"),s=a("vHhr"),c=a("Wj20"),l=a("0xDb"),m=[{key:1,name:"营销素材"},{key:2,name:"地推素材"},{key:3,name:"每日一读"}],p=(m.reduce(function(t,e){return t[e.key]=e.name,t},{}),{type:1,content:"",imgs:[],link:"",id:void 0,img_type:0,publish_time:null}),d={name:"itemDetail",components:{Tinymce:i.a,Mupload:r.a,Sticky:s.a},props:{isEdit:{type:Boolean,default:!1}},data:function(){return{postForm:o()({},p),loading:!1,typeOptions:m,temp:{},rules:{publish_time:[{required:!0,message:"请输入发布时间",trigger:"blur"}],content:[{required:!0,message:"请输入内容描述",trigger:"blur"}],type:[{required:!0,message:"请输入类型",trigger:"change"}],imgs:[{type:"array",required:!0,message:"上传的图片必须在1-9张之间",min:1,max:9,trigger:"change"}]}}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetchData(t)}else this.postForm=o()({},p)},methods:{fetchData:function(t){var e=this;this.loading=!0,Object(c.b)(t).then(function(t){e.postForm=t.data.data,e.postForm.publish_time=Object(l.f)(e.postForm.publish_time),e.postForm.imgs=JSON.parse(e.postForm.imgs),e.loading=!1}).catch(function(t){console.log(t)})},submitForm:function(){var t=this;this.$refs.postForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.resetData(t.postForm),t.isEdit?(t.loading=!0,Object(c.d)(t.temp,t.postForm.id).then(function(e){200==e.data.code?t.$message({type:"success",message:e.data.data}):t.$message({type:"error",message:e.data.msg}),t.loading=!1})):(t.loading=!0,Object(c.a)(t.temp).then(function(e){200==e.data.code?(t.$message({type:"success",message:e.data.data}),t.$router.push("/community/share_material")):t.$message({type:"error",message:e.data.msg}),t.loading=!1}))})},resetData:function(t){this.temp={publish_time:Object(l.e)(t.publish_time),type:t.type,content:t.content,imgs:t.imgs}},imageSuccessCBK:function(t){console.log(t),this.postForm.imgs=t}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"createPost-container",attrs:{"element-loading-text":"处理中.."}},[a("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules,size:"small"}},[a("sticky",{attrs:{className:"sub-navbar draft"}},[a("router-link",{attrs:{to:"/community/share_material"}},[a("el-button",{staticStyle:{margin:"10px","margin-bottom":"0"},attrs:{type:"text",icon:"el-icon-back"}},[t._v("返回列表")])],1)],1),t._v(" "),a("div",{staticClass:"createPost-main-container"},[a("el-form-item",{attrs:{label:"发布类型"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择发布类型",prop:"type"},model:{value:t.postForm.type,callback:function(e){t.$set(t.postForm,"type",e)},expression:"postForm.type"}},t._l(t.typeOptions,function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t.key}})}))],1),t._v(" "),a("el-form-item",{staticClass:"tinymini",attrs:{label:"内容描述",prop:"content"}},[a("br"),t._v(" "),a("Tinymce",{ref:"editor",attrs:{height:300},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"图片上传",prop:"imgs"}},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("Mupload",{attrs:{imgs:t.postForm.imgs},on:{successCBK:t.imageSuccessCBK}}),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v("[竖图（建议尺寸）:宽750px*高1334px，格式JPG，PNG   横图（建议尺寸）:宽750px*高562px，格式JPG，PNG]")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"发布时间",prop:"publish_time"}},[a("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.postForm.publish_time,callback:function(e){t.$set(t.postForm,"publish_time",e)},expression:"postForm.publish_time"}})],1),t._v(" "),a("div",{staticStyle:{clear:"both","text-align":"center"}},[a("el-button",{staticStyle:{margin:"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("发布")])],1)],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(d,u,!1,function(t){a("fOsQ")},"data-v-0bc6eaea",null);e.a=g.exports},KVgE:function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,'\n.createPost-container[data-v-0bc6eaea] {\n  position: relative;\n}\n.createPost-container .createPost-main-container[data-v-0bc6eaea] {\n    padding: 40px 45px 20px 50px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-0bc6eaea] {\n      position: relative;\n      margin-bottom: 10px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-0bc6eaea]:after {\n        content: "";\n        display: table;\n        clear: both;\n}\n.createPost-container .createPost-main-container .postInfo-container .postInfo-container-item[data-v-0bc6eaea] {\n        float: left;\n}\n.createPost-container .createPost-main-container .editor-container[data-v-0bc6eaea] {\n      min-height: 500px;\n      margin: 0 0 30px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container[data-v-0bc6eaea] {\n        text-align: right;\n        margin-right: 10px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container .editor-upload-btn[data-v-0bc6eaea] {\n          display: inline-block;\n}\n.createPost-container .word-counter[data-v-0bc6eaea] {\n    width: 40px;\n    position: absolute;\n    right: -10px;\n    top: 0px;\n}\n',""])},fOsQ:function(t,e,a){var n=a("KVgE");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("125b137e",n,!0)},wuzU:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={name:"editForm",components:{ItemDetail:a("I9Id").a}},o={render:function(){var t=this.$createElement;return(this._self._c||t)("item-detail",{attrs:{"is-edit":!0}})},staticRenderFns:[]},i=a("VU/8")(n,o,!1,null,null,null);e.default=i.exports}});