webpackJsonp([42],{C4DJ:function(e,t,r){(e.exports=r("FZ+f")(!1)).push([e.i,"\n.pagination-container[data-v-722b7215]{\n  margin-top: 10px;\n}\n.el-pagination[data-v-722b7215]{\n  float: right;\n}\n.el-form-item[data-v-722b7215]{\n\tmargin-bottom: 10px;\n}\n\n",""])},CQoH:function(e,t,r){var o=r("C4DJ");"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);r("rjj0")("8c4acdfe",o,!0)},zvBu:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("BO1k"),i=r.n(o),a=r("woOf"),l=r.n(a),s=r("ayk+");function n(e,t){return Object(s.a)({url:"/pddtrades/"+t,method:"put",params:e})}var d=r("y/Jw"),u=r("0xDb"),c=[{key:"order_sn",name:"订单号"},{key:"goods_name",name:"商品名"},{key:"goods_id",name:"商品ID"},{key:"uname",name:"会员名"},{key:"uid",name:"会员id"},{key:"p_id",name:"PID"},{key:"create_time",name:"下单时间"}],m=[{key:-1,name:"订单已失效"},{key:0,name:"订单已支付"},{key:1,name:"订单已成团"},{key:2,name:"订单确认收货"},{key:3,name:"订单审核成功"},{key:4,name:"订单审核失败"}],p=m.reduce(function(e,t){return e[t.key]=t.name,e},{}),_={data:function(){return{tableKey:0,list:null,total:null,listLoading:!0,listQuery:{page:1,limit:10,searchJoin:"and",search:"",searchFields:"",orderBy:"id",sortedBy:"desc",filter:""},searchQuery:{search:"",searchFields:"",field:"uname",keyword:"",checked:"",order_status:"",trade_uid:"",uid:null},fieldOptions:c,statusOptions:m,multipleSelection:[],checkAll:0,isIndeterminate:!1,temp:{},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建"},rules:{order_sn:[{required:!0,message:"请输入订单号",trigger:"blur"}],goods_name:[{required:!0,message:"请输入名称",trigger:"blur"}],goods_id:[{required:!0,message:"请输入商品ID",trigger:"blur"}]}}},filters:{titleFilter:function(e){return e.length>20?e.substring(20)+"...":e},tradeuidFilter:function(e){return e.substring(e.length-6)},statusFilter:function(e){return p[e]},checkedFilter:function(e){return checkedArray[e]},numFilter:function(e){var t=Number(e).toFixed(2);return Number(t)}},created:function(){this.getList()},methods:{getList:function(){var e,t=this;this.listLoading=!0,(e=this.listQuery,Object(s.a)({url:"/pddtrades",method:"get",params:e})).then(function(e){t.list=e.data.data;for(var r=t.list.length-1;r>=0;r--)t.list[r].uname=null==t.list[r].user?"":t.list[r].user.ddusername;t.total=e.data.total,t.listLoading=!1})},handleFilter:function(){var e=l()({},this.searchQuery);console.log(this.searchQuery);var t=e.search,r=e.searchFields;e.field&&e.keyword&&"uname"!=e.field&&(t+=e.field+":"+e.keyword+";",r+=e.field+":=;"),e.uid&&(t+="uid:"+e.uid+";",r+="uid:=;"),e.checked&&(t+="checked:"+e.checked+";",r+="checked:=;"),e.order_status&&(t+="order_status:"+e.order_status+";",r+="order_status:=;"),e.trade_uid&&(t+="trade_id:"+e.trade_uid+";",r+="trade_id:like;"),this.listQuery.search=t,this.listQuery.searchFields=r,this.listQuery.page=1,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e,this.multipleSelection.length==this.list.length?(this.checkAll=2,this.isIndeterminate=!0):this.multipleSelection.length>0?(this.checkAll=1,this.isIndeterminate=!0):(this.checkAll=0,this.isIndeterminate=!1)},handleDelete:function(){var e=this;if(this.multipleSelection.length<=0)return this.$notify({title:"警告",message:"请选择要删除的条目",type:"warning"}),!1;this.$confirm("此操作将数据彻底删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"error"}).then(function(){var t="",r=!0,o=!1,a=void 0;try{for(var l,s=i()(e.multipleSelection);!(r=(l=s.next()).done);r=!0){t+=l.value.id+","}}catch(e){o=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw a}}e.listLoading=!0,n({del:1},t).then(function(t){e.$message({type:"success",message:t.data.message}),e.getList(),e.listLoading=!1})}).catch(function(){})},resetTemp:function(e){this.temp=e?{id:e.id,order_sn:e.order_sn,goods_id:e.goods_id,goods_name:e.goods_name,goods_price:e.goods_price,goods_quantity:e.goods_quantity,order_amount:e.order_amount,order_pay_time:null==e.order_pay_time?null:Object(u.f)(e.order_pay_time),order_create_time:null==e.order_create_time?null:Object(u.f)(e.order_create_time),promotion_rate:e.promotion_rate,promotion_amount:e.promotion_amount,order_verify_time:null==e.order_verify_time?null:Object(u.f)(e.order_verify_time),order_group_success_time:null==e.order_group_success_time?null:Object(u.f)(e.order_group_success_time),uname:null==e.user?"":e.user.ddusername,p_id:e.p_id,order_status:e.order_status}:{id:void 0,order_sn:"",goods_id:"",goods_name:"",goods_price:0,goods_quantity:0,order_amount:0,order_pay_time:null,order_create_time:null,promotion_rate:0,promotion_amount:0,order_verify_time:null,order_group_success_time:null,uname:"",p_id:"",order_status:null}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.dataForm.clearValidate()})},createData:function(){var e=this;this.$refs.dataForm.validate(function(t){var r;t&&(e.temp.order_verify_time=""==e.temp.order_verify_time?null:Object(u.e)(e.temp.order_verify_time),e.temp.order_pay_time=""==e.temp.order_pay_time?null:Object(u.e)(e.temp.order_pay_time),e.temp.order_create_time=""==e.temp.order_create_time?null:Object(u.e)(e.temp.order_create_time),e.temp.order_group_success_time=""==e.temp.order_group_success_time?null:Object(u.e)(e.temp.order_group_success_time),(r=e.temp,Object(s.a)({url:"/pddtrades",method:"post",data:r})).then(function(){e.temp.user=null,e.list.unshift(e.temp),e.dialogFormVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})}))})},handleUpdate:function(e){var t=this;this.resetTemp(e),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.dataForm.clearValidate()})},updateData:function(){var e=this;this.$refs.dataForm.validate(function(t){t&&(e.temp.order_pay_time=""==e.temp.order_pay_time?null:Object(u.e)(e.temp.order_pay_time),e.temp.order_create_time=""==e.temp.order_create_time?null:Object(u.e)(e.temp.order_create_time),e.temp.order_verify_time=""==e.temp.order_verify_time?null:Object(u.e)(e.temp.order_verify_time),e.temp.order_group_success_time=""==e.temp.order_group_success_time?null:Object(u.e)(e.temp.order_group_success_time),n(l()({},e.temp)).then(function(){var t=!0,r=!1,o=void 0;try{for(var a,l=i()(e.list);!(t=(a=l.next()).done);t=!0){var s=a.value;if(s.id===e.temp.id){var n=e.list.indexOf(s);e.list.splice(n,1,e.temp);break}}}catch(e){r=!0,o=e}finally{try{!t&&l.return&&l.return()}finally{if(r)throw o}}e.dialogFormVisible=!1,e.$notify({title:"成功",message:"更新成功",type:"success",duration:2e3})}))})},getUserId:function(){var e=this;"uname"==this.searchQuery.field&&""!=this.searchQuery.keyword&&Object(d.c)(this.searchQuery.keyword).then(function(t){e.searchQuery.uid=t.data})}}},f={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticClass:"app-container",attrs:{"element-loading-text":"Loading"}},[r("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"10px"}},[r("el-select",{staticStyle:{width:"105px"},attrs:{clearable:"",placeholder:"搜索字段"},model:{value:e.searchQuery.field,callback:function(t){e.$set(e.searchQuery,"field",t)},expression:"searchQuery.field"}},e._l(e.fieldOptions,function(e){return r("el-option",{key:e.key,attrs:{label:e.name,value:e.key}})})),e._v("\n      :\n      "),r("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"关键字"},on:{blur:e.getUserId},model:{value:e.searchQuery.keyword,callback:function(t){e.$set(e.searchQuery,"keyword",t)},expression:"searchQuery.keyword"}}),e._v(" "),r("el-input",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{placeholder:"会员ID"},model:{value:e.searchQuery.uid,callback:function(t){e.$set(e.searchQuery,"uid",t)},expression:"searchQuery.uid"}}),e._v(" "),r("el-select",{staticStyle:{width:"105px"},attrs:{clearable:"",placeholder:"订单状态"},model:{value:e.searchQuery.order_status,callback:function(t){e.$set(e.searchQuery,"order_status",t)},expression:"searchQuery.order_status"}},e._l(e.statusOptions,function(e){return r("el-option",{key:e.key,attrs:{label:e.name,value:e.key}})})),e._v(" "),r("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("筛选")]),e._v(" "),r("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleCreate}},[e._v("添加")])],1),e._v(" "),r("el-table",{ref:"multipleTable",attrs:{size:"small",data:e.list,border:"",fit:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[r("el-table-column",{attrs:{type:"selection",width:"35"}}),e._v(" "),r("el-table-column",{attrs:{prop:"order_sn",label:"推广订单编号",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticClass:"link-type",on:{click:function(r){e.handleUpdate(t.row)}}},[e._v("\n            "+e._s(t.row.order_sn)+"\n          ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"goods_name",label:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{attrs:{title:t.row.goods_name}},[e._v("\n            "+e._s(e._f("titleFilter")(t.row.goods_name))+"\n          ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"goods_id",label:"商品ID",width:"110"}}),e._v(" "),r("el-table-column",{attrs:{prop:"goods_quantity",label:"数量",width:"60"}}),e._v(" "),r("el-table-column",{attrs:{prop:"goods_price",label:"单价(元)",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("numFilter")(t.row.goods_price/100)))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"order_amount",label:"总额(元)",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("numFilter")(t.row.order_amount/100)))]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"promotion_rate",label:"佣金比例",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.promotion_rate>=250?r("span",{staticStyle:{color:"red"}},[e._v(e._s(t.row.promotion_rate/1e3))]):r("span",[e._v(e._s(t.row.promotion_rate/1e3))])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"promotion_amount",label:"佣金(元)",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.promotion_amount>0?r("span",[e._v(e._s(e._f("numFilter")(t.row.promotion_amount/100)))]):r("span",[e._v("--")])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"p_id",label:"PID",width:"90"}}),e._v(" "),r("el-table-column",{attrs:{label:"会员",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{staticClass:"link-type"},[e._v("\n            "+e._s(t.row.uname)+"\n          ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"order_status",label:"状态",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e._f("statusFilter")(t.row.order_status))+"\n        ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",{staticStyle:{color:"blue"}},[e._v("入库:"+e._s(t.row.create_time))]),r("br"),e._v(" "),r("span",{staticStyle:{color:"green"}},[e._v("更改:"+e._s(t.row.update_time))]),r("br"),e._v(" "),r("span",{staticStyle:{color:"orange"}},[e._v("生成:"+e._s(e._f("parseTime")(t.row.order_create_time)))]),r("br"),e._v(" "),null!=t.row.order_verify_time?r("span",{staticStyle:{color:"red"}},[e._v("审核:"+e._s(e._f("parseTime")(t.row.order_verify_time)))]):r("span",{staticStyle:{color:"red"}},[e._v("审核:--")])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"operate",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){e.handleUpdate(t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),r("div",{staticClass:"pagination-container"},[0==e.checkAll?r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:function(t){e.toggleSelection(e.list)}}},[e._v("全选")]):1==e.checkAll?r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:function(t){e.toggleSelection(e.list)}}},[e._v("反选")]):r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:function(t){e.toggleSelection()}}},[e._v("取消全选")]),e._v(" "),r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){e.handleDelete()}}},[e._v("彻底删除")]),e._v(" "),r("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[e.listQuery.limit],"page-size":e.listQuery.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1),e._v(" "),r("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"dataForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{rules:e.rules,size:"small",model:e.temp,"label-position":"left","label-width":"90px"}},[r("el-form-item",{attrs:{label:"商品名",prop:"goods_name"}},[r("el-input",{model:{value:e.temp.goods_name,callback:function(t){e.$set(e.temp,"goods_name",t)},expression:"temp.goods_name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品id",prop:"goods_id"}},[r("el-input",{model:{value:e.temp.goods_id,callback:function(t){e.$set(e.temp,"goods_id",t)},expression:"temp.goods_id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"订单号",prop:"order_sn"}},[r("el-input",{model:{value:e.temp.order_sn,callback:function(t){e.$set(e.temp,"order_sn",t)},expression:"temp.order_sn"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"单价(元)",prop:"goods_price"}},[r("el-input",{model:{value:e.temp.goods_price,callback:function(t){e.$set(e.temp,"goods_price",t)},expression:"temp.goods_price"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"数量",prop:"goods_quantity"}},[r("el-input",{model:{value:e.temp.goods_quantity,callback:function(t){e.$set(e.temp,"goods_quantity",t)},expression:"temp.goods_quantity"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"成交额(元)",prop:"order_amount"}},[r("el-input",{model:{value:e.temp.order_amount,callback:function(t){e.$set(e.temp,"order_amount",t)},expression:"temp.order_amount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"佣金比例",prop:"promotion_rate"}},[r("el-input",{attrs:{placeholder:"即0‰ （数据格式 120 表示120‰）"},model:{value:e.temp.promotion_rate,callback:function(t){e.$set(e.temp,"promotion_rate",t)},expression:"temp.promotion_rate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"佣金",prop:"promotion_amount"}},[r("el-input",{attrs:{placeholder:"佣金金额，单位为分"},model:{value:e.temp.promotion_amount,callback:function(t){e.$set(e.temp,"promotion_amount",t)},expression:"temp.promotion_amount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"PID",prop:"p_id"}},[r("el-input",{model:{value:e.temp.p_id,callback:function(t){e.$set(e.temp,"p_id",t)},expression:"temp.p_id"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"会员名",prop:"uname"}},[r("el-input",{attrs:{size:"small"},model:{value:e.temp.uname,callback:function(t){e.$set(e.temp,"uname",t)},expression:"temp.uname"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"创建时间",prop:"order_create_time"}},[r("el-date-picker",{attrs:{size:"small",type:"datetime",placeholder:"请选择时间"},model:{value:e.temp.order_create_time,callback:function(t){e.$set(e.temp,"order_create_time",t)},expression:"temp.order_create_time"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"审核时间",prop:"order_verify_time"}},[r("el-date-picker",{attrs:{size:"small",type:"datetime",placeholder:"请选择时间"},model:{value:e.temp.order_verify_time,callback:function(t){e.$set(e.temp,"order_verify_time",t)},expression:"temp.order_verify_time"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"成团时间",prop:"order_group_success_time"}},[r("el-date-picker",{attrs:{size:"small",type:"datetime",placeholder:"请选择时间"},model:{value:e.temp.order_group_success_time,callback:function(t){e.$set(e.temp,"order_group_success_time",t)},expression:"temp.order_group_success_time"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"支付时间",prop:"order_pay_time"}},[r("el-date-picker",{attrs:{size:"small",type:"datetime",placeholder:"请选择时间"},model:{value:e.temp.order_pay_time,callback:function(t){e.$set(e.temp,"order_pay_time",t)},expression:"temp.order_pay_time"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"订单状态",prop:"order_status"}},[r("el-select",{staticClass:"filter-item",attrs:{size:"small"},model:{value:e.temp.order_status,callback:function(t){e.$set(e.temp,"order_status",t)},expression:"temp.order_status"}},e._l(e.statusOptions,function(e){return r("el-option",{key:e.key,attrs:{label:e.name,value:e.key}})}))],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),"create"==e.dialogStatus?r("el-button",{attrs:{type:"primary"},on:{click:e.createData}},[e._v("添加")]):r("el-button",{attrs:{type:"primary"},on:{click:e.updateData}},[e._v("更新")])],1)],1)],1)},staticRenderFns:[]};var h=r("VU/8")(_,f,!1,function(e){r("CQoH")},"data-v-722b7215",null);t.default=h.exports}});