webpackJsonp([14],{LzQM:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"editForm",components:{ItemDetail:o("ksVq").a}},n={render:function(){var t=this.$createElement;return(this._self._c||t)("item-detail",{attrs:{"is-edit":!0}})},staticRenderFns:[]},s=o("VU/8")(a,n,!1,null,null,null);e.default=s.exports},kDg4:function(t,e,o){(t.exports=o("FZ+f")(!1)).push([t.i,'\n.createPost-container[data-v-7d1d604c] {\n  position: relative;\n}\n.createPost-container .createPost-main-container[data-v-7d1d604c] {\n    padding: 40px 45px 20px 50px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-7d1d604c] {\n      position: relative;\n      margin-bottom: 10px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-7d1d604c]:after {\n        content: "";\n        display: table;\n        clear: both;\n}\n.createPost-container .createPost-main-container .postInfo-container .postInfo-container-item[data-v-7d1d604c] {\n        float: left;\n}\n.createPost-container .createPost-main-container .editor-container[data-v-7d1d604c] {\n      min-height: 500px;\n      margin: 0 0 30px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container[data-v-7d1d604c] {\n        text-align: right;\n        margin-right: 10px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container .editor-upload-btn[data-v-7d1d604c] {\n          display: inline-block;\n}\n.createPost-container .word-counter[data-v-7d1d604c] {\n    width: 40px;\n    position: absolute;\n    right: -10px;\n    top: 0px;\n}\n',""])},ksVq:function(t,e,o){"use strict";var a=o("woOf"),n=o.n(a),s=(o("mw3O"),o("YVAe")),i=o("eqaL"),r=o("D4dz"),c=o("vHhr"),l=o("BVQU"),m=o("0xDb"),p=[{key:1,name:"新手指引"},{key:2,name:"精品课程"}],d=(p.reduce(function(t,e){return t[e.key]=e.name,t},{}),{type:1,content:"",imgs:[],img_first:null,link:"",id:void 0,img_type:0,publish_time:null}),u={name:"itemDetail",components:{Tinymce:s.a,Upload:i.a,Mupload:r.a,Sticky:c.a},props:{isEdit:{type:Boolean,default:!1}},data:function(){return{postForm:n()({},d),loading:!1,typeOptions:p,temp:{},rules:{publish_time:[{required:!0,message:"请输入发布时间",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}],link:[{required:!0,message:"请输入视频链接",trigger:"blur"}],type:[{required:!0,message:"请输入类型",trigger:"change"}],imgs:[{type:"array",required:!0,message:"上传的图片必须在1-9张之间",min:1,max:9,trigger:"change"}]}}},created:function(){if(this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetchData(t)}else this.postForm=n()({},d)},methods:{fetchData:function(t){var e=this;this.loading=!0,Object(l.b)(t).then(function(t){e.postForm=t.data.data,e.postForm.publish_time=Object(m.f)(e.postForm.publish_time),e.postForm.imgs=JSON.parse(e.postForm.imgs),e.postForm.img_first=e.postForm.imgs[0],e.loading=!1}).catch(function(t){console.log(t)})},submitForm:function(){var t=this,e=this.resetData();this.$refs.postForm.validate(function(o){if(!o)return console.log("error submit!!"),!1;t.isEdit?(t.loading=!0,Object(l.d)(e,t.postForm.id).then(function(e){200==e.data.code?t.$message({type:"success",message:e.data.data}):t.$message({type:"error",message:e.data.msg}),t.loading=!1})):(t.loading=!0,Object(l.a)(e).then(function(e){200==e.data.code?(t.$message({type:"success",message:e.data.data}),t.$router.push("/community/share_business")):t.$message({type:"error",message:e.data.msg}),t.loading=!1}))})},resetData:function(){var t={publish_time:Object(m.e)(this.postForm.publish_time),type:this.postForm.type,content:this.postForm.content};return 1==this.postForm.type?(t.link=this.postForm.link,t.imgs=[this.postForm.img_first],this.postForm.imgs=t.imgs):t.imgs=this.postForm.imgs,t},imageSuccessCBK:function(t){this.postForm.imgs=t}}},g={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"createPost-container",attrs:{"element-loading-text":"处理中.."}},[o("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules,size:"small"}},[o("sticky",{attrs:{className:"sub-navbar draft"}},[o("router-link",{attrs:{to:"/community/share_business"}},[o("el-button",{staticStyle:{margin:"10px","margin-bottom":"0"},attrs:{type:"text",icon:"el-icon-back"}},[t._v("返回列表")])],1)],1),t._v(" "),o("div",{staticClass:"createPost-main-container"},[o("el-form-item",{attrs:{label:"发布类型",prop:"type"}},[o("el-select",{attrs:{clearable:"",placeholder:"请选择发布类型"},model:{value:t.postForm.type,callback:function(e){t.$set(t.postForm,"type",e)},expression:"postForm.type"}},t._l(t.typeOptions,function(t){return o("el-option",{key:t.key,attrs:{label:t.name,value:t.key}})}))],1),t._v(" "),1==t.postForm.type?o("el-form-item",{attrs:{label:"视频标题",prop:"content"}},[o("el-col",{attrs:{span:10}},[o("el-input",{attrs:{size:"small",placeholder:"请输入视频标题"},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1)],1):o("el-form-item",{staticClass:"tinymini",attrs:{label:"内容描述",prop:"content"}},[o("br"),t._v(" "),o("Tinymce",{ref:"editor",attrs:{height:300},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1),t._v(" "),1==t.postForm.type?o("el-form-item",{attrs:{label:"视频上传",prop:"link"}},[o("el-col",{attrs:{span:10}},[o("el-input",{attrs:{size:"small",placeholder:"请输入视频链接"},model:{value:t.postForm.link,callback:function(e){t.$set(t.postForm,"link",e)},expression:"postForm.link"}})],1)],1):t._e(),t._v(" "),1==t.postForm.type?o("el-form-item",{attrs:{label:"封面图片",prop:"imgs"}},[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("Upload",{model:{value:t.postForm.img_first,callback:function(e){t.$set(t.postForm,"img_first",e)},expression:"postForm.img_first"}}),t._v(" "),o("span",{staticStyle:{float:"left","margin-top":"-30px","margin-left":"170px",color:"red"}},[t._v("[固定尺寸：宽654px*高368px，格式JPG，PNG]")])],1)]):o("el-form-item",{attrs:{label:"图片上传",prop:"imgs"}},[o("div",{staticStyle:{"margin-bottom":"20px"}},[o("Mupload",{attrs:{imgs:t.postForm.imgs},on:{successCBK:t.imageSuccessCBK}}),t._v(" "),o("span",{staticStyle:{color:"red"}},[t._v("[竖图（建议尺寸）:宽750px*高1334px，格式JPG，PNG   横图（建议尺寸）:宽750px*高562px，格式JPG，PNG]")])],1)]),t._v(" "),o("el-form-item",{attrs:{label:"发布时间",prop:"publish_time"}},[o("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:t.postForm.publish_time,callback:function(e){t.$set(t.postForm,"publish_time",e)},expression:"postForm.publish_time"}})],1),t._v(" "),o("div",{staticStyle:{clear:"both","text-align":"center"}},[o("el-button",{staticStyle:{margin:"10px"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("发布")])],1)],1)],1)],1)},staticRenderFns:[]};var f=o("VU/8")(u,g,!1,function(t){o("wLNu")},"data-v-7d1d604c",null);e.a=f.exports},wLNu:function(t,e,o){var a=o("kDg4");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("bbb24c2c",a,!0)}});