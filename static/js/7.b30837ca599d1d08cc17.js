webpackJsonp([7],{"1KxW":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,'\n.createPost-container[data-v-4abdb0f6] {\n  position: relative;\n}\n.createPost-container .createPost-main-container[data-v-4abdb0f6] {\n    padding: 40px 45px 20px 50px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-4abdb0f6] {\n      position: relative;\n      margin-bottom: 10px;\n}\n.createPost-container .createPost-main-container .postInfo-container[data-v-4abdb0f6]:after {\n        content: "";\n        display: table;\n        clear: both;\n}\n.createPost-container .createPost-main-container .postInfo-container .postInfo-container-item[data-v-4abdb0f6] {\n        float: left;\n}\n.createPost-container .createPost-main-container .editor-container[data-v-4abdb0f6] {\n      min-height: 500px;\n      margin: 0 0 30px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container[data-v-4abdb0f6] {\n        text-align: right;\n        margin-right: 10px;\n}\n.createPost-container .createPost-main-container .editor-container .editor-upload-btn-container .editor-upload-btn[data-v-4abdb0f6] {\n          display: inline-block;\n}\n.createPost-container .word-counter[data-v-4abdb0f6] {\n    width: 40px;\n    position: absolute;\n    right: -10px;\n    top: 0px;\n}\n.tip[data-v-4abdb0f6] {\n  color: #ccc;\n  font-size: 10px;\n  padding-left: 5px;\n}\n.txt_r[data-v-4abdb0f6] {\n  text-align: right;\n}\n.list-items[data-v-4abdb0f6] {\n  width: 100%;\n  clear: both;\n  padding: 0 10px;\n  border-top: 1px solid #eee;\n}\n.list-items .detail-item[data-v-4abdb0f6] {\n  border-bottom: 1px solid #eee;\n  width: 100%;\n  padding-bottom: 5px;\n  padding-top: 5px;\n  clear: both;\n}\n.list-add[data-v-4abdb0f6] {\n  float: right;\n  margin-top: -5px;\n}\n',""])},"79YR":function(t,e,a){var o=a("sFO+");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("c14180c4",o,!0)},"A7+s":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o={name:"createForm",components:{ItemDetail:a("VWDc").a}},i={render:function(){var t=this.$createElement;return(this._self._c||t)("item-detail",{attrs:{"is-edit":!1}})},staticRenderFns:[]},r=a("VU/8")(o,i,!1,null,null,null);e.default=r.exports},VWDc:function(t,e,a){"use strict";var o=a("BO1k"),i=a.n(o),r=a("woOf"),s=a.n(r),n=a("5aCZ"),l=a("e9xc"),c=a("GYsj"),d={name:"fileUpload",props:{value:String},computed:{fileUrl:function(){return this.value}},data:function(){return{uploadUrl:"http://api.kalighting.cn/api/admin",tempUrl:""}},methods:{rmFile:function(){this.emitInput("")},emitInput:function(t){this.$emit("input",t)},handleImageScucess:function(t,e){console.log("上传文件后返回结果",t),this.tempUrl=t.url,this.emitInput(this.tempUrl)},beforeUpload:function(t){var e=t.size/1024/1024<50;return e||this.$message.error("上传大小不能超过 50MB!"),e}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-container"},[a("el-upload",{staticClass:"el-upload",attrs:{drag:"",multiple:!1,"show-file-list":!1,action:t.uploadUrl+"/doc_upload","on-success":t.handleImageScucess,"before-upload":t.beforeUpload}},[a("i",{staticClass:"el-icon-upload"}),t._v(" "),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:null!==t.fileUrl&&t.fileUrl.length>1,expression:"fileUrl!==null && fileUrl.length>1"}],staticClass:"file-preview"},[a("a",{attrs:{href:t.fileUrl,target:"_blank"}},[t._v(t._s(t.fileUrl))]),t._v(" "),a("i",{staticClass:"el-icon-delete",on:{click:t.rmFile}})])],1)},staticRenderFns:[]};var m=a("VU/8")(d,p,!1,function(t){a("79YR")},"data-v-a6989a46",null).exports,u=a("vHhr"),f=a("UgCr"),v={cate_id:1,name:"",index_img:"",description:"",info:"",if_hot:0,id:void 0,sort:0,specification:"",imgs:[],features:[],docs:[]},g={id:void 0,title:"",content:"",img:""},h={id:void 0,name:"",link:""},b={name:"itemDetail",components:{Tinymce:n.a,Upload:l.a,Sticky:u.a,Mupload:c.a,Dupload:m},props:{isEdit:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,a,o){""===a?(t.$message({message:e.field+"为必传项",type:"error"}),o(null)):o()};return{postForm:s()({},v),featuresForm:s()({},g),docsForm:s()({},h),loading:!1,productCateOptions:null,dialogFormVisible:!1,dialogStatus:"",dialogDocFormVisible:!1,dialogDocStatus:"",textMap:{update:"编辑",create:"创建"},rules:{name:[{validator:e}],index_img:[{validator:e}],features:[{type:"array",required:!0,message:"数据必须在1-9个之间",min:1,max:9,trigger:"change"}]},featuresRules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],img:[{required:!0,message:"请上传图片",trigger:"change"}]},docsRules:{name:[{required:!0,message:"文件名长度不超过5",min:1,max:5,trigger:"blur"}],link:[{required:!0,message:"请上传文件",trigger:"change"}]}}},created:function(){if(this.getAllCates(),this.isEdit){var t=this.$route.params&&this.$route.params.id;this.fetchData(t)}else this.postForm=s()({},v)},methods:{fetchData:function(t){var e=this;Object(f.c)(t).then(function(t){console.log("this.postForm",t.data),e.postForm=t.data;for(var a=e.postForm.features.length-1;a>=0;a--)e.postForm.features[a]=JSON.parse(e.postForm.features[a])}).catch(function(t){console.log(t)})},getAllCates:function(){var t=this;Object(f.d)().then(function(e){t.productCateOptions=e.data})},submitForm:function(){var t=this;this.$refs.postForm.validate(function(e){if(!e)return console.log("error submit!!"),!1;t.loading=!0;var a=s()({},t.postForm);t.isEdit?Object(f.f)(a,a.id).then(function(e){200==e.data.code?t.$notify({title:"成功",message:e.data.message,type:"success",duration:2e3}):t.$notify({title:"失败",message:e.data.error,type:"error",duration:2e3})}):Object(f.a)(a).then(function(e){200==e.data.code?t.$notify({title:"成功",message:e.data.message,type:"success",duration:2e3}):t.$notify({title:"失败",message:e.data.error,type:"error",duration:2e3})}),t.$router.push("/products/product-list"),t.loading=!1})},imageSuccessCBK:function(t){this.postForm.imgs=t},handleDocCreate:function(){var t=this;this.docsForm=s()({},h),this.dialogDocStatus="create",this.dialogDocFormVisible=!0,this.$nextTick(function(){t.$refs.docsForm.clearValidate()})},createDocData:function(){var t=this;this.$refs.docsForm.validate(function(e){e&&(t.docsForm.id=t.postForm.docs.length+1,t.postForm.docs.push(t.docsForm),t.dialogDocFormVisible=!1)})},handleDocUpdate:function(t){var e=this;this.docsForm=s()({},t),this.dialogDocStatus="update",this.dialogDocFormVisible=!0,this.$nextTick(function(){e.$refs.docsForm.clearValidate()})},updateDocData:function(){var t=this;this.$refs.docsForm.validate(function(e){if(e){var a=!0,o=!1,r=void 0;try{for(var s,n=i()(t.postForm.docs);!(a=(s=n.next()).done);a=!0){var l=s.value;if(l.id===t.docsForm.id){var c=t.postForm.docs.indexOf(l);t.postForm.docs.splice(c,1,t.docsForm);break}}}catch(t){o=!0,r=t}finally{try{!a&&n.return&&n.return()}finally{if(o)throw r}}t.dialogDocFormVisible=!1}})},deleteDocData:function(t){var e=this.postForm.docs.indexOf(t);this.postForm.docs.splice(e,1)},handleCreate:function(){var t=this;this.featuresForm=s()({},g),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.featuresForm.clearValidate()})},createData:function(){var t=this;this.postForm.features.length>9&&(this.$message("最多只能上传9个"),this.dialogFormVisible=!1),this.$refs.featuresForm.validate(function(e){e&&(t.featuresForm.id=t.postForm.features.length+1,t.postForm.features.push(t.featuresForm),t.dialogFormVisible=!1)})},handleUpdate:function(t){var e=this;this.featuresForm=s()({},t),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.featuresForm.clearValidate()})},updateData:function(){var t=this;this.$refs.featuresForm.validate(function(e){if(e){var a=!0,o=!1,r=void 0;try{for(var s,n=i()(t.postForm.features);!(a=(s=n.next()).done);a=!0){var l=s.value;if(l.id===t.featuresForm.id){var c=t.postForm.features.indexOf(l);t.postForm.features.splice(c,1,t.featuresForm);break}}}catch(t){o=!0,r=t}finally{try{!a&&n.return&&n.return()}finally{if(o)throw r}}t.dialogFormVisible=!1}})},deleteData:function(t){var e=this.postForm.features.indexOf(t);this.postForm.features.splice(e,1)}}},F={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"postForm",attrs:{model:t.postForm,rules:t.rules,size:"small","label-width":"130px"}},[a("sticky",{attrs:{className:"sub-navbar draft"}},[a("router-link",{attrs:{to:"/products/product-list"}},[a("el-button",{staticStyle:{margin:"10px","margin-bottom":"0"},attrs:{type:"primary",icon:"el-icon-back"}},[t._v("返回列表")])],1),t._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{margin:"10px",float:"right","margin-bottom":"0"},attrs:{type:"success"},on:{click:t.submitForm}},[t._v("保存")])],1),t._v(" "),a("el-form-item",{attrs:{label:"产品名称"}},[a("el-col",{attrs:{span:8}},[a("el-input",{model:{value:t.postForm.name,callback:function(e){t.$set(t.postForm,"name",e)},expression:"postForm.name"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"产品分类"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:t.postForm.cate_id,callback:function(e){t.$set(t.postForm,"cate_id",e)},expression:"postForm.cate_id"}},t._l(t.productCateOptions,function(t){return a("el-option",{key:t.id,attrs:{label:t.sub_name,value:t.id}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:"产品描述"}},[a("el-col",{attrs:{span:8}},[a("el-input",{model:{value:t.postForm.description,callback:function(e){t.$set(t.postForm,"description",e)},expression:"postForm.description"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"产品介绍"}},[a("el-input",{staticClass:"el-textarea__inner",attrs:{type:"textarea",rows:3,autosize:"",placeholder:"请输入内容"},model:{value:t.postForm.info,callback:function(e){t.$set(t.postForm,"info",e)},expression:"postForm.info"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"产品首图"}},[a("div",{staticStyle:{width:"180px",height:"180px"}},[a("Upload",{model:{value:t.postForm.index_img,callback:function(e){t.$set(t.postForm,"index_img",e)},expression:"postForm.index_img"}})],1),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v(" [必填,建议尺寸：宽800px*高800px，格式jpg,png]")])]),t._v(" "),a("el-form-item",{attrs:{label:"产品轮播图"}},[a("div",{staticStyle:{"margin-bottom":"20px"}},[a("Mupload",{attrs:{imgs:t.postForm.imgs},on:{successCBK:t.imageSuccessCBK}}),t._v(" "),a("br"),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v(" [必填,建议尺寸：宽800px*高800px，格式jpg,png]")])],1)]),t._v(" "),a("el-form-item",{attrs:{label:"产品特点",prop:"features"}},[a("div",{staticClass:"list-add"},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleCreate}},[t._v("添加特点")])],1),t._v(" "),a("div",{staticClass:"list-items"},[a("ul",t._l(t.postForm.features,function(e,o){return a("li",{staticClass:"detail-item",staticStyle:{"border-bottom":"1px solid #eee","padding-bottom":"5px"}},[a("el-col",{staticStyle:{"padding-right":"5px","text-align":"right","line-height":"70px",color:"#606266"},attrs:{span:2}},[a("b",[t._v("特征"+t._s(o+1)+":")])]),t._v(" "),a("el-col",{staticStyle:{"padding-left":"5px","padding-right":"5px","padding-top":"15px"},attrs:{span:10}},[a("b",{staticStyle:{color:"gray"},domProps:{innerHTML:t._s(e.title)}}),t._v(" "),a("br"),t._v(" "),a("p",{staticStyle:{color:"gray","line-height":"18px"},domProps:{innerHTML:t._s(e.content)}})]),t._v(" "),a("el-col",{attrs:{span:6}},[a("img",{staticStyle:{float:"left","margin-left":"5px"},attrs:{src:e.img,width:"auto",height:"80"}})]),t._v(" "),a("el-col",{staticStyle:{"padding-top":"20px"},attrs:{span:6}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){t.handleUpdate(e)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.deleteData(e)}}},[t._v("删除")])],1),t._v(" "),a("div",{staticStyle:{clear:"both",width:"100%",height:"0"}})],1)}))])]),t._v(" "),a("el-form-item",{attrs:{label:"产品规格"}},[a("div",{staticClass:"editor-container"},[a("Tinymce",{ref:"editor",attrs:{height:400},model:{value:t.postForm.specification,callback:function(e){t.$set(t.postForm,"specification",e)},expression:"postForm.specification"}})],1)]),t._v(" "),a("el-form-item",{attrs:{label:"下载文档",prop:"docs"}},[a("div",{staticClass:"list-add"},[a("el-button",{attrs:{type:"primary"},on:{click:t.handleDocCreate}},[t._v("添加文档")])],1),t._v(" "),a("div",{staticClass:"list-items"},[a("ul",t._l(t.postForm.docs,function(e,o){return a("li",{staticClass:"detail-item",staticStyle:{"border-bottom":"1px solid #eee","padding-bottom":"5px"}},[a("el-col",{staticStyle:{"padding-right":"5px","text-align":"right","line-height":"70px",color:"#606266"},attrs:{span:2}},[a("b",[t._v("文档"+t._s(o+1)+":")])]),t._v(" "),a("el-col",{staticStyle:{"padding-left":"5px","padding-right":"5px","padding-top":"15px"},attrs:{span:16}},[a("b",{staticStyle:{color:"gray"},domProps:{innerHTML:t._s(e.name)}}),t._v(" "),a("br"),t._v(" "),a("a",{staticStyle:{color:"gray","line-height":"18px"},domProps:{innerHTML:t._s(e.link)}})]),t._v(" "),a("el-col",{staticStyle:{"padding-top":"20px"},attrs:{span:6}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){t.handleDocUpdate(e)}}},[t._v("修改")]),t._v(" "),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){t.deleteDocData(e)}}},[t._v("删除")])],1),t._v(" "),a("div",{staticStyle:{clear:"both",width:"100%",height:"0"}})],1)}))])]),t._v(" "),a("el-form-item",{attrs:{label:"热门推荐"}},[a("el-radio-group",{model:{value:t.postForm.if_hot,callback:function(e){t.$set(t.postForm,"if_hot",e)},expression:"postForm.if_hot"}},[a("el-radio",{attrs:{label:0}},[t._v("否")]),t._v(" "),a("el-radio",{attrs:{label:1}},[t._v("是")])],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"排序"}},[a("el-col",{attrs:{span:2}},[a("el-input",{model:{value:t.postForm.sort,callback:function(e){t.$set(t.postForm,"sort",e)},expression:"postForm.sort"}})],1)],1)],1),t._v(" "),a("el-dialog",{staticClass:"features",attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,width:"60%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"featuresForm",attrs:{model:t.featuresForm,rules:t.featuresRules,size:"small"}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-col",{attrs:{span:8}},[a("el-input",{model:{value:t.featuresForm.title,callback:function(e){t.$set(t.featuresForm,"title",e)},expression:"featuresForm.title"}})],1),t._v(" "),a("span",{staticStyle:{color:"red","padding-left":"5px"}},[t._v("必填")])],1),t._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:3,autosize:"",placeholder:"请输入内容"},model:{value:t.featuresForm.content,callback:function(e){t.$set(t.featuresForm,"content",e)},expression:"featuresForm.content"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"图片",prop:"img"}},[a("el-col",{attrs:{span:6}},[a("Upload",{model:{value:t.featuresForm.img,callback:function(e){t.$set(t.featuresForm,"img",e)},expression:"featuresForm.img"}})],1),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v(" [必填,建议尺寸：宽600px*高600px，格式JPG，PNG]")])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createData}},[t._v("添加")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateData}},[t._v("更新")])],1)],1),t._v(" "),a("el-dialog",{staticClass:"docs",attrs:{title:t.textMap[t.dialogDocStatus],visible:t.dialogDocFormVisible,width:"60%"},on:{"update:visible":function(e){t.dialogDocFormVisible=e}}},[a("el-form",{ref:"docsForm",attrs:{model:t.docsForm,rules:t.docsRules,size:"small"}},[a("el-form-item",{attrs:{label:"文档名称",prop:"name"}},[a("el-col",{attrs:{span:8}},[a("el-input",{model:{value:t.docsForm.name,callback:function(e){t.$set(t.docsForm,"name",e)},expression:"docsForm.name"}})],1),t._v(" "),a("span",{staticStyle:{color:"red","padding-left":"5px"}},[t._v("必填，不超过5个字")])],1),t._v(" "),a("el-form-item",{attrs:{label:"文件",prop:"link"}},[a("el-col",{attrs:{span:6}},[a("Dupload",{model:{value:t.docsForm.link,callback:function(e){t.$set(t.docsForm,"link",e)},expression:"docsForm.link"}})],1),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v(" [必传,大小不超过5M]")])],1)],1),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogDocFormVisible=!1}}},[t._v("取消")]),t._v(" "),"create"==t.dialogDocStatus?a("el-button",{attrs:{type:"primary"},on:{click:t.createDocData}},[t._v("添加")]):a("el-button",{attrs:{type:"primary"},on:{click:t.updateDocData}},[t._v("更新")])],1)],1)],1)},staticRenderFns:[]};var x=a("VU/8")(b,F,!1,function(t){a("c3gX")},"data-v-4abdb0f6",null);e.a=x.exports},c3gX:function(t,e,a){var o=a("1KxW");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("rjj0")("15df732e",o,!0)},"sFO+":function(t,e,a){(t.exports=a("FZ+f")(!1)).push([t.i,"\n.upload-container[data-v-a6989a46] {\n  width: 100%;\n  height: 100%;\n  position: relative;\n}\n.upload-container .image-uploader[data-v-a6989a46] {\n    height: 100%;\n}\n.upload-container .image-preview[data-v-a6989a46] {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    border: 1px dashed #d9d9d9;\n}\n.upload-container .image-preview .image-preview-wrapper[data-v-a6989a46] {\n      position: relative;\n      width: 100%;\n      height: 100%;\n}\n.upload-container .image-preview .image-preview-wrapper img[data-v-a6989a46] {\n        width: 100%;\n        height: 100%;\n}\n.upload-container .image-preview .image-preview-action[data-v-a6989a46] {\n      position: absolute;\n      width: 100%;\n      height: 100%;\n      left: 0;\n      top: 0;\n      cursor: default;\n      text-align: center;\n      color: #fff;\n      opacity: 0;\n      font-size: 20px;\n      background-color: rgba(0, 0, 0, 0.5);\n      -webkit-transition: opacity .3s;\n      transition: opacity .3s;\n      cursor: pointer;\n      text-align: center;\n      line-height: 200px;\n}\n.upload-container .image-preview .image-preview-action .el-icon-delete[data-v-a6989a46] {\n        font-size: 36px;\n}\n.upload-container .image-preview:hover .image-preview-action[data-v-a6989a46] {\n      opacity: 1;\n}\n",""])}});